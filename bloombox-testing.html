
<!--
`<bloombox-testing>` provides UI for displaying and editing product QA testing results.

@group Bloombox Elements
@element bloombox-testing
@demo demo/index.html
@homepage bloombox.github.io
-->

<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-label/iron-label.html">

<link rel="import" href="../paper-slider/paper-slider.html">
<link rel="import" href="../paper-checkbox/paper-checkbox.html">
<link rel="import" href="../paper-radio-group/paper-radio-group.html">
<link rel="import" href="../paper-radio-button/paper-radio-button.html">

<link rel="import" href="../bloombox-styles/bloombox-styles.html">
<link rel="import" href="../bloombox-product/bloombox-product.html">


<dom-module id="bloombox-testing">
  <template>
    <style is="custom-style" include="bloombox-styles">
      :host {
        display: inline-block;
        position: relative;
        min-height: 35px;
        width: 100%;
        cursor: default;
      }

      :host iron-label {
        padding: 5px;
        border-radius: 3px;
        margin-right: 10px;
      }

      :host .zerostate iron-label {
        display: flex;
        padding: 0;
      }

      :host paper-slider {
        --paper-slider-active-color: var(--bloombox-green-primary);
        --paper-slider-knob-color: var(--bloombox-green-primary);
        --paper-slider-pin-color: var(--bloombox-green-primary);
        --paper-slider-secondary-color: #333;
      }

      :host .no-test-data:after {
        content: 'Results Pending';
        font-size: 80%;
        text-transform: uppercase;
        font-style: italic;
        position: absolute;
        top: -5px;
        bottom: -5px;
        width: 100%;
        text-align: center;
        padding: 5px;
        background: var(--no-tests-overlay-background, white);
        opacity: 0.85;
      }

      :host .bloombox-test-results-display iron-label {
        background: var(--base-label-background, #009688);
        color: var(--base-label-color, white);
      }

      :host .terpene-toggle-option {
        display: flex;
        align-items: center;
        margin-right: 5px;
        height: 30px;
      }

      :host .test-result-terpenes {
        flex: 1 1 50%;
        margin-right: 10%;
        max-height: 200px;
        min-width: 390px;
        background: #dfdfdf;
        padding: 5px;
        overflow-x: scroll;
      }

      :host .test-result-terpenes h3 {
        margin: 0;
        font-size: 8pt;
        text-transform: uppercase;
        -webkit-margin-start: 0;
        -webkit-margin-end: 0;
        -webkit-margin-before: 0;
        -webkit-margin-after: 0;
        font-weight: bold;
        text-decoration: underline;
      }

      /*  myrcene styling  */
      :host .bloombox-test-results-display .terpene-label.myrcene-label {
        background: var(--testing-myrcene-color, #393b79);
      }
      :host .test-result-terpenes.zerostate paper-checkbox.terpene-myrcene {
        --paper-checkbox-checked-color: var(--testing-myrcene-color, #393b79);
        --paper-checkbox-checked-ink-color: var(--testing-myrcene-color, #393b79);
        --paper-checkbox-unchecked-ink-color: var(--testing-myrcene-color, #393b79);
      }
      :host .test-result-terpenes.zerostate paper-slider.terpene-myrcene {
        --paper-slider-knob-color: var(--testing-myrcene-color, #393b79);
        --paper-slider-pin-color: var(--testing-myrcene-color, #393b79);
        --paper-slider-active-color: var(--testing-myrcene-color, #393b79);
      }

      /*  caryophyllene-oxide styling  */
      :host .bloombox-test-results-display .terpene-label.caryophyllene-oxide-label {
        background: var(--testing-caryophyllene-oxide-color, #5254a3);
      }
      :host .test-result-terpenes.zerostate paper-checkbox.terpene-caryophyllene-oxide {
        --paper-checkbox-checked-color: var(--testing-caryophyllene-oxide-color, #5254a3);
        --paper-checkbox-checked-ink-color: var(--testing-caryophyllene-oxide-color, #5254a3);
        --paper-checkbox-unchecked-ink-color: var(--testing-caryophyllene-oxide-color, #5254a3);
      }
      :host .test-result-terpenes.zerostate paper-slider.terpene-caryophyllene-oxide {
        --paper-slider-active-color: var(--testing-caryophyllene-oxide-color, #5254a3);
        --paper-slider-knob-color: var(--testing-caryophyllene-oxide-color, #5254a3);
        --paper-slider-pin-color: var(--testing-caryophyllene-oxide-color, #5254a3);
      }

      /*  linalool styling  */
      :host .bloombox-test-results-display .terpene-label.linalool-label {
        background: var(--testing-linalool-color, #6b6ecf);
      }
      :host .test-result-terpenes.zerostate paper-checkbox.terpene-linalool {
        --paper-checkbox-checked-color: var(--testing-linalool-color, #6b6ecf);
        --paper-checkbox-checked-ink-color: var(--testing-linalool-color, #6b6ecf);
        --paper-checkbox-unchecked-ink-color: var(--testing-linalool-color, #6b6ecf);
      }
      :host .test-result-terpenes.zerostate paper-slider.terpene-linalool {
        --paper-slider-active-color: var(--testing-linalool-color, #6b6ecf);
        --paper-slider-knob-color: var(--testing-linalool-color, #6b6ecf);
        --paper-slider-pin-color: var(--testing-linalool-color, #6b6ecf);
      }

      /*  beta-caryophyllene styling  */
      :host .bloombox-test-results-display .terpene-label.beta-caryophyllene-label {
        background: var(--testing-beta-caryophyllene-color, #9c9ede);
      }
      :host .test-result-terpenes.zerostate paper-checkbox.terpene-beta-caryophyllene {
        --paper-checkbox-checked-color: var(--testing-beta-caryophyllene-color, #9c9ede);
        --paper-checkbox-checked-ink-color: var(--testing-beta-caryophyllene-color, #9c9ede);
        --paper-checkbox-unchecked-ink-color: var(--testing-beta-caryophyllene-color, #9c9ede);
      }
      :host .test-result-terpenes.zerostate paper-slider.terpene-beta-caryophyllene {
        --paper-slider-active-color: var(--testing-beta-caryophyllene-color, #9c9ede);
        --paper-slider-knob-color: var(--testing-beta-caryophyllene-color, #9c9ede);
        --paper-slider-pin-color: var(--testing-beta-caryophyllene-color, #9c9ede);
      }

      /*  alpha-humulene styling  */
      :host .bloombox-test-results-display .terpene-label.alpha-humulene-label {
        background: var(--testing-alpha-humulene-color, #637939);
      }
      :host .test-result-terpenes.zerostate paper-checkbox.terpene-alpha-humulene {
        --paper-checkbox-checked-color: var(--testing-alpha-humulene-color, #637939);
        --paper-checkbox-checked-ink-color: var(--testing-alpha-humulene-color, #637939);
        --paper-checkbox-unchecked-ink-color: var(--testing-alpha-humulene-color, #637939);
      }
      :host .test-result-terpenes.zerostate paper-slider.terpene-alpha-humulene {
        --paper-slider-active-color: var(--testing-alpha-humulene-color, #637939);
        --paper-slider-knob-color: var(--testing-alpha-humulene-color, #637939);
        --paper-slider-pin-color: var(--testing-alpha-humulene-color, #637939);
      }

      /*  alpha-terpineol styling  */
      :host .bloombox-test-results-display .terpene-label.alpha-terpineol-label {
        background: var(--testing-alpha-terpineol-color, #8ca252);
      }
      :host .test-result-terpenes.zerostate paper-checkbox.terpene-alpha-terpineol {
        --paper-checkbox-checked-color: var(--testing-alpha-terpineol-color, #8ca252);
        --paper-checkbox-checked-ink-color: var(--testing-alpha-terpineol-color, #8ca252);
        --paper-checkbox-unchecked-ink-color: var(--testing-alpha-terpineol-color, #8ca252);
      }
      :host .test-result-terpenes.zerostate paper-slider.terpene-alpha-terpineol {
        --paper-slider-active-color: var(--testing-alpha-terpineol-color, #8ca252);
        --paper-slider-knob-color: var(--testing-alpha-terpineol-color, #8ca252);
        --paper-slider-pin-color: var(--testing-alpha-terpineol-color, #8ca252);
      }

      /*  camphene styling  */
      :host .bloombox-test-results-display .terpene-label.camphene-label {
        background: var(--testing-camphene-color, #b5cf6b);
      }
      :host .test-result-terpenes.zerostate paper-checkbox.terpene-camphene {
        --paper-checkbox-checked-color: var(--testing-camphene-color, #b5cf6b);
        --paper-checkbox-checked-ink-color: var(--testing-camphene-color, #b5cf6b);
        --paper-checkbox-unchecked-ink-color: var(--testing-camphene-color, #b5cf6b);
      }
      :host .test-result-terpenes.zerostate paper-slider.terpene-camphene {
        --paper-slider-active-color: var(--testing-camphene-color, #b5cf6b);
        --paper-slider-knob-color: var(--testing-camphene-color, #b5cf6b);
        --paper-slider-pin-color: var(--testing-camphene-color, #b5cf6b);
      }
      
      /*  fenchol styling  */
      :host .bloombox-test-results-display .terpene-label.fenchol-label {
        background: var(--testing-fenchol-color, #cedb9c);
      }
      :host .test-result-terpenes.zerostate paper-checkbox.terpene-fenchol {
        --paper-checkbox-checked-color: var(--testing-fenchol-color, #cedb9c);
        --paper-checkbox-checked-ink-color: var(--testing-fenchol-color, #cedb9c);
        --paper-checkbox-unchecked-ink-color: var(--testing-fenchol-color, #cedb9c);
      }
      :host .test-result-terpenes.zerostate paper-slider.terpene-fenchol {
        --paper-slider-active-color: var(--testing-fenchol-color, #cedb9c);
        --paper-slider-knob-color: var(--testing-fenchol-color, #cedb9c);
        --paper-slider-pin-color: var(--testing-fenchol-color, #cedb9c);
      }

      /*  beta-pinene styling  */
      :host .bloombox-test-results-display .terpene-label.beta-pinene-label {
        background: var(--testing-beta-pinene-color, #bd9e39);  
      }
      :host .test-result-terpenes.zerostate paper-checkbox.terpene-beta-pinene {
        --paper-checkbox-checked-color: var(--testing-beta-pinene-color, #bd9e39);
        --paper-checkbox-checked-ink-color: var(--testing-beta-pinene-color, #bd9e39);
        --paper-checkbox-unchecked-ink-color: var(--testing-beta-pinene-color, #bd9e39);
      }
      :host .test-result-terpenes.zerostate paper-slider.terpene-beta-pinene {
        --paper-slider-active-color: var(--testing-beta-pinene-color, #bd9e39);
        --paper-slider-knob-color: var(--testing-beta-pinene-color, #bd9e39);
        --paper-slider-pin-color: var(--testing-beta-pinene-color, #bd9e39);
      }  

      /*  alpha-terpinine styling  */
      :host .bloombox-test-results-display .terpene-label.alpha-terpinine-label {
        background: var(--testing-alpha-terpinine-color, #e7ba52);  
      }
      :host .test-result-terpenes.zerostate paper-checkbox.terpene-alpha-terpinine {
        --paper-checkbox-checked-color: var(--testing-alpha-terpinine-color, #e7ba52);
        --paper-checkbox-checked-ink-color: var(--testing-alpha-terpinine-color, #e7ba52);
        --paper-checkbox-unchecked-ink-color: var(--testing-alpha-terpinine-color, #e7ba52);
      }
      :host .test-result-terpenes.zerostate paper-slider.terpene-alpha-terpinine {
        --paper-slider-active-color: var(--testing-alpha-terpinine-color, #e7ba52);
        --paper-slider-knob-color: var(--testing-alpha-terpinine-color, #e7ba52);
        --paper-slider-pin-color: var(--testing-alpha-terpinine-color, #e7ba52);
      }

      /*  alpha-pinene styling  */
      :host .bloombox-test-results-display .terpene-label.alpha-pinene-label {
        background: var(--testing-alpha-pinene-color, #8c6d31);  
      }
      :host .test-result-terpenes.zerostate paper-checkbox.terpene-alpha-pinene {
        --paper-checkbox-checked-color: var(--testing-alpha-pinene-color, #8c6d31);
        --paper-checkbox-checked-ink-color: var(--testing-alpha-pinene-color, #8c6d31);
        --paper-checkbox-unchecked-ink-color: var(--testing-alpha-pinene-color, #8c6d31);
      }
      :host .test-result-terpenes.zerostate paper-slider.terpene-alpha-pinene {
        --paper-slider-active-color: var(--testing-alpha-pinene-color, #8c6d31);
        --paper-slider-knob-color: var(--testing-alpha-pinene-color, #8c6d31);
        --paper-slider-pin-color: var(--testing-alpha-pinene-color, #8c6d31);
      }  

      /*  gamma-terpinine styling  */
      :host .bloombox-test-results-display .terpene-label.gamma-terpinine-label {
        background: var(--testing-gamma-terpinine-color, #e7cb94);  
      }
      :host .test-result-terpenes.zerostate paper-checkbox.terpene-gamma-terpinine {
        --paper-checkbox-checked-color: var(--testing-gamma-terpinine-color, #e7cb94);
        --paper-checkbox-checked-ink-color: var(--testing-gamma-terpinine-color, #e7cb94);
        --paper-checkbox-unchecked-ink-color: var(--testing-gamma-terpinine-color, #e7cb94);
      }
      :host .test-result-terpenes.zerostate paper-slider.terpene-gamma-terpinine {
        --paper-slider-active-color: var(--testing-gamma-terpinine-color, #e7cb94);
        --paper-slider-knob-color: var(--testing-gamma-terpinine-color, #e7cb94);
        --paper-slider-pin-color: var(--testing-gamma-terpinine-color, #e7cb94);
      }  

      /*  limonene styling  */
      :host .bloombox-test-results-display .terpene-label.limonene-label {
        background: var(--testing-limonene-color, #ad494a);  
      }
      :host .test-result-terpenes.zerostate paper-checkbox.terpene-limonene {
        --paper-checkbox-checked-color: var(--testing-limonene-color, #ad494a);
        --paper-checkbox-checked-ink-color: var(--testing-limonene-color, #ad494a);
        --paper-checkbox-unchecked-ink-color: var(--testing-limonene-color, #ad494a);
      }
      :host .test-result-terpenes.zerostate paper-slider.terpene-limonene {
        --paper-slider-active-color: var(--testing-limonene-color, #ad494a);
        --paper-slider-knob-color: var(--testing-limonene-color, #ad494a);
        --paper-slider-pin-color: var(--testing-limonene-color, #ad494a);
      }  

      /*  carene styling  */
      :host .bloombox-test-results-display .terpene-label.carene-label {
        background: var(--testing-carene-color, #d6616b);  
      }
      :host .test-result-terpenes.zerostate paper-checkbox.terpene-carene {
        --paper-checkbox-checked-color: var(--testing-carene-color, #d6616b);
        --paper-checkbox-checked-ink-color: var(--testing-carene-color, #d6616b);
        --paper-checkbox-unchecked-ink-color: var(--testing-carene-color, #d6616b);
      }
      :host .test-result-terpenes.zerostate paper-slider.terpene-carene {
        --paper-slider-active-color: var(--testing-carene-color, #d6616b);
        --paper-slider-knob-color: var(--testing-carene-color, #d6616b);
        --paper-slider-pin-color: var(--testing-carene-color, #d6616b);
      }  

      /*  beta-ocimene styling  */
      :host .bloombox-test-results-display .terpene-label.beta-ocimene-label {
        background: var(--testing-beta-ocimene-color, #e7969c);  
      }
      :host .test-result-terpenes.zerostate paper-checkbox.terpene-beta-ocimene {
        --paper-checkbox-checked-color: var(--testing-beta-ocimene-color, #e7969c);
        --paper-checkbox-checked-ink-color: var(--testing-beta-ocimene-color, #e7969c);
        --paper-checkbox-unchecked-ink-color: var(--testing-beta-ocimene-color, #e7969c);
      }
      :host .test-result-terpenes.zerostate paper-slider.terpene-beta-ocimene {
        --paper-slider-active-color: var(--testing-beta-ocimene-color, #e7969c);
        --paper-slider-knob-color: var(--testing-beta-ocimene-color, #e7969c);
        --paper-slider-pin-color: var(--testing-beta-ocimene-color, #e7969c);
      }  

      /*  alpha-phellandrene styling  */
      :host .bloombox-test-results-display .terpene-label.alpha-phellandrene-label {
        background: var(--testing-alpha-phellandrene-color, #a55194);  
      }
      :host .test-result-terpenes.zerostate paper-checkbox.terpene-alpha-phellandrene {
        --paper-checkbox-checked-color: var(--testing-alpha-phellandrene-color, #a55194);
        --paper-checkbox-checked-ink-color: var(--testing-alpha-phellandrene-color, #a55194);
        --paper-checkbox-unchecked-ink-color: var(--testing-alpha-phellandrene-color, #a55194);
      }
      :host .test-result-terpenes.zerostate paper-slider.terpene-alpha-phellandrene {
        --paper-slider-active-color: var(--testing-alpha-phellandrene-color, #a55194);
        --paper-slider-knob-color: var(--testing-alpha-phellandrene-color, #a55194);
        --paper-slider-pin-color: var(--testing-alpha-phellandrene-color, #a55194);
      }  

      /*  terpinolene styling  */
      :host .bloombox-test-results-display .terpene-label.terpinolene-label {
        background: var(--testing-terpinolene-color, #ce6dbd);  
      }
      :host .test-result-terpenes.zerostate paper-checkbox.terpene-terpinolene {
        --paper-checkbox-checked-color: var(--testing-terpinolene-color, #ce6dbd);
        --paper-checkbox-checked-ink-color: var(--testing-terpinolene-color, #ce6dbd);
        --paper-checkbox-unchecked-ink-color: var(--testing-terpinolene-color, #ce6dbd);
      }
      :host .test-result-terpenes.zerostate paper-slider.terpene-terpinolene {
        --paper-slider-active-color: var(--testing-terpinolene-color, #ce6dbd);
        --paper-slider-knob-color: var(--testing-terpinolene-color, #ce6dbd);
        --paper-slider-pin-color: var(--testing-terpinolene-color, #ce6dbd);
      }  

      :host .test-result-ratings {
        flex: 1 1 30%;
      }

      :host .test-result-terpenes {
        flex: 1 1 70%;
      }

      :host .test-rating-mode {
        margin-bottom: 15px;
      }

      :host .test-result-rating:not(:first-child) {
        margin-top: -20px;
      }

      :host .test-result-rating paper-slider {
        margin-top: -10px;
      }

      :host .test-result-rating paper-slider /deep/ paper-input,
      :host .terpene-amount-container paper-slider /deep/ paper-input {
        min-width: 55px;
      }

      :host .test-result-rating iron-label span {
        line-height: 34px;
      }

      :host .test-result-rating iron-label span.unit-label {
        line-height: 37px;
        padding-left: 3px;
      }

      :host .test-result-terpenes.zerostate paper-checkbox {
        display: block;
        margin: 5px 0;
      }
    </style>

    <div id="widgetWrap" class="bloombox-testing-content">
      <!-- Zero State UI -->
      <template is="dom-if" if="[[zerostate]]">
        <div class="test-result-ratings zerostate">
          <template is="dom-if" if="[[dynamicRatingMode]]">
          <div class="test-rating-mode">
            <label id="unitLabel">Unit:</label>
            <paper-radio-group
              attr-for-selected="name"
              selected="{{ratingMode}}"
              allow-empty-selection="false"
              aria-labelledby="unitLabel">
              <paper-radio-button name="mg">mg</paper-radio-button>
              <paper-radio-button name="%">%</paper-radio-button>
            </paper-radio-group>
          </div><!-- end div.test-rating-mode -->
          </template>
          <div class="test-result-rating">
            <iron-label>
              <span>THC:</span>
              <paper-slider
                id="thcValue"
                editable
                value="{{thc}}"
                class="thc-value test-result-rating-value form-item"
                secondary-progress="[[_ratingModeParams.limit_hint]]"
                step="[[_ratingModeParams.step]]"
                max="[[_ratingModeParams.max]]"></paper-slider>
              <span class="unit-label">[[ratingMode]]</span>
            </iron-label>
          </div><!-- end div.test-result-rating -->
          <div class="test-result-rating">
            <iron-label>
              <span>CBD:</span>
              <paper-slider
                id="cbdValue"
                editable
                value="{{cbd}}"
                class="cbd-value test-result-rating-value form-item"
                secondary-progress="[[_ratingModeParams.limit_hint]]"
                step="[[_ratingModeParams.step]]"
                max="[[_ratingModeParams.max]]"></paper-slider>
              <span class="unit-label">[[ratingMode]]</span>
            </iron-label>
          </div><!-- end div.test-result-rating -->
        </div><!-- end div.test-result-ratings -->

        <template is="dom-if" if="[[_rich]]">
          <!-- Terpenes -->
          <div class="test-result-terpenes zerostate">
            <h3>Terpenes</h3>
            <div class="terpene-toggle-option myrcene-toggle-option">
              <div class="myrcene-toggle-container">
                <paper-checkbox checked="{{terpenes.myrcene.presence}}" class="form-item terpene-result terpene-myrcene" noink>Myrcene</paper-checkbox>
              </div><!-- end .myrcene-toggle-container -->
              <template is="dom-if" if="[[terpenes.myrcene.presence]]">
                <div class="terpene-amount-container">
                  <paper-slider value="{{terpenes.myrcene.rating}}" max="3.0" min=".01" editable step=".01" class="form-item terpene-myrcene"></paper-slider>
                </div><!-- end .terpene-amount-container -->
                <div class="terpene-percentage-label">%</div>
              </template>
            </div><!-- end .myrcene-toggle-option -->

            <div class="terpene-toggle-option caryophyllene-oxide-toggle-option">
              <div class="caryophyllene-oxide-toggle-container">
                <paper-checkbox checked="{{terpenes.caryophylleneOxide.presence}}" class="form-item terpene-result terpene-caryophyllene-oxide" noink>Caryophyllene oxide</paper-checkbox>
              </div><!-- end .caryophyllene-oxide-toggle-container -->
              <template is="dom-if" if="[[terpenes.caryophylleneOxide.presence]]">
                <div class="terpene-amount-container">
                  <paper-slider  value="{{terpenes.caryophylleneOxide.rating}}" max="3.0" min=".01" editable step=".01" class="form-item terpene-caryophyllene-oxide"></paper-slider>
                </div><!-- end .terpene-amount-container -->
                <div class="terpene-percentage-label">%</div>
              </template>
            </div><!-- end .caryophyllene-oxide-toggle-option -->

            <div class="terpene-toggle-option linalool-toggle-option">
              <div class="linalool-toggle-container">
                <paper-checkbox checked="{{terpenes.linalool.presence}}" class="form-item terpene-result terpene-linalool" noink>Linalool</paper-checkbox>
              </div><!-- end .linalool-toggle-container -->
              <template is="dom-if" if="[[terpenes.linalool.presence]]">
                <div class="terpene-amount-container">
                  <paper-slider  value="{{terpenes.linalool.rating}}" max="3.0" min=".01" editable step=".01" class="form-item terpene-linalool"></paper-slider>
                </div><!-- end .terpene-amount-container -->
                <div class="terpene-percentage-label">%</div>
              </template>
            </div><!-- end .linalool-toggle-option -->

            <div class="terpene-toggle-option beta-caryophyllene-toggle-option">
              <div class="beta-caryophyllene-toggle-container">
                <paper-checkbox checked="{{terpenes.betaCaryophyllene.presence}}" class="form-item terpene-result terpene-beta-caryophyllene" noink>β-Caryophyllene</paper-checkbox>
              </div><!-- end .beta-caryophyllene-toggle-container -->
              <template is="dom-if" if="[[terpenes.betaCaryophyllene.presence]]">
                <div class="terpene-amount-container">
                  <paper-slider  value="{{terpenes.betaCaryophyllene.rating}}" max="3.0" min=".01" editable step=".01" class="form-item terpene-beta-caryophyllene"></paper-slider>
                </div><!-- end .terpene-amount-container -->
                <div class="terpene-percentage-label">%</div>
              </template>
            </div><!-- end .beta-caryophyllene-toggle-option -->

            <div class="terpene-toggle-option alpha-humulene-toggle-option">
              <div class="alpha-humulene-toggle-container">
                <paper-checkbox checked="{{terpenes.alphaHumulene.presence}}" class="form-item terpene-result terpene-alpha-humulene" noink>α-Humulene</paper-checkbox>
              </div><!-- end .alpha-humulene-toggle-container -->
              <template is="dom-if" if="[[terpenes.alphaHumulene.presence]]">
                <div class="terpene-amount-container">
                  <paper-slider  value="{{terpenes.alphaHumulene.rating}}" max="3.0" min=".01" editable step=".01" class="form-item terpene-alpha-humulene"></paper-slider>
                </div><!-- end .terpene-amount-container -->
                <div class="terpene-percentage-label">%</div>
              </template>
            </div><!-- end .alpha-humulene-toggle-option -->

            <div class="terpene-toggle-option alpha-terpineol-toggle-option">
              <div class="alpha-terpineol-toggle-container">
                <paper-checkbox checked="{{terpenes.alphaTerpineol.presence}}" class="form-item terpene-result terpene-alpha-terpineol" noink>α-Terpineol</paper-checkbox>
              </div><!-- end .alpha-terpineol-toggle-container -->
              <template is="dom-if" if="[[terpenes.alphaTerpineol.presence]]">
                <div class="terpene-amount-container">
                  <paper-slider value="{{terpenes.alphaTerpineol.rating}}" max="3.0" min=".01" editable step=".01" class="form-item terpene-alpha-terpineol"></paper-slider>
                </div><!-- end .terpene-amount-container -->
                <div class="terpene-percentage-label">%</div>
              </template>
            </div><!-- end .alpha-terpineol-toggle-option -->

            <div class="terpene-toggle-option camphene-toggle-option">
              <div class="camphene-toggle-container">
                <paper-checkbox checked="{{terpenes.camphene.presence}}" class="form-item terpene-result terpene-camphene" noink>Camphene</paper-checkbox>
              </div><!-- end .camphene-toggle-container -->
              <template is="dom-if" if="[[terpenes.camphene.presence]]">
                <div class="terpene-amount-container">
                  <paper-slider value="{{camphene.rating}}" max="3.0" min=".01" editable step=".01" class="form-item terpene-camphene"></paper-slider>
                </div><!-- end .terpene-amount-container -->
                <div class="terpene-percentage-label">%</div>
              </template>
            </div><!-- end .camphene-toggle-option -->

            <div class="terpene-toggle-option fenchol-toggle-option">
              <div class="fenchol-toggle-container">
                <paper-checkbox checked="{{terpenes.fenchol.presence}}" class="form-item terpene-result terpene-fenchol" noink>Fenchol</paper-checkbox>
              </div><!-- end .fenchol-toggle-container -->
              <template is="dom-if" if="[[terpenes.fenchol.presence]]">
                <div class="terpene-amount-container">
                  <paper-slider value="{{terpenes.fenchol.rating}}" max="3.0" min=".01" editable step=".01" class="form-item terpene-fenchol"></paper-slider>
                </div><!-- end .terpene-amount-container -->
                <div class="terpene-percentage-label">%</div>
              </template>
            </div><!-- end .fenchol-toggle-option -->

            <div class="terpene-toggle-option alpha-pinene-toggle-option">
              <div class="alpha-pinene-toggle-container">
                <paper-checkbox checked="{{terpenes.alphaPinene.presence}}" class="form-item terpene-result terpene-alpha-pinene" noink>α-Pinene</paper-checkbox>
              </div><!-- end .alpha-pinene-toggle-container -->
              <template is="dom-if" if="[[terpenes.alphaPinene.presence]]">
                <div class="terpene-amount-container">
                  <paper-slider value="{{terpenes.alphaPinene.rating}}" max="3.0" min=".01" editable step=".01" class="form-item terpene-alpha-pinene"></paper-slider>
                </div><!-- end .terpene-amount-container -->
                <div class="terpene-percentage-label">%</div>
              </template>
            </div><!-- end .alpha-pinene-toggle-option -->

            <div class="terpene-toggle-option beta-pinene-toggle-option">
              <div class="beta-pinene-toggle-container">
                <paper-checkbox checked="{{terpenes.betaPinene.presence}}" class="form-item terpene-result terpene-beta-pinene" noink>β-Pinene</paper-checkbox>
              </div><!-- end .beta-pinene-toggle-container -->
              <template is="dom-if" if="[[terpenes.betaPinene.presence]]">
                <div class="terpene-amount-container">
                  <paper-slider value="{{terpenes.betaPinene.rating}}" max="3.0" min=".01" editable step=".01" class="form-item terpene-beta-pinene"></paper-slider>
                </div><!-- end .terpene-amount-container -->
                <div class="terpene-percentage-label">%</div>
              </template>
            </div><!-- end .beta-pinene-toggle-option -->

            <div class="terpene-toggle-option alpha-terpinine-toggle-option">
              <div class="alpha-terpinine-toggle-container">
                <paper-checkbox checked="{{terpenes.alphaTerpinine.presence}}" class="form-item terpene-result terpene-alpha-terpinine" noink>α-Terpinine</paper-checkbox>
              </div><!-- end .alpha-terpinine-toggle-container -->
              <template is="dom-if" if="[[terpenes.alphaTerpinine.presence]]">
                <div class="terpene-amount-container">
                  <paper-slider value="{{terpenes.alphaTerpinine.rating}}" max="3.0" min=".01" editable step=".01" class="form-item terpene-alpha-terpinine"></paper-slider>
                </div><!-- end .terpene-amount-container -->
                <div class="terpene-percentage-label">%</div>
              </template>
            </div><!-- end .alpha-terpinine-toggle-option -->

            <div class="terpene-toggle-option gamma-terpinine-toggle-option">
              <div class="gamma-terpinine-toggle-container">
                <paper-checkbox checked="{{terpenes.gammaTerpinine.presence}}" class="form-item terpene-result terpene-gamma-terpinine" noink>γ-Terpinine</paper-checkbox>
              </div><!-- end .gamma-terpinine-toggle-container -->
              <template is="dom-if" if="[[terpenes.gammaTerpinine.presence]]">
                <div class="terpene-amount-container">
                  <paper-slider value="{{terpenes.gammaTerpinine.rating}}" max="3.0" min=".01" editable step=".01" class="form-item terpene-gamma-terpinine"></paper-slider>
                </div><!-- end .terpene-amount-container -->
                <div class="terpene-percentage-label">%</div>
              </template>
            </div><!-- end .gamma-terpinine-toggle-option -->

            <div class="terpene-toggle-option limonene-toggle-option">
              <div class="limonene-toggle-container">
                <paper-checkbox checked="{{terpenes.limonene.presence}}" class="form-item terpene-result terpene-limonene" noink>Limonene</paper-checkbox>
              </div><!-- end .limonene-toggle-container -->
              <template is="dom-if" if="[[terpenes.limonene.presence]]">
                <div class="terpene-amount-container">
                  <paper-slider value="{{terpenes.limonene.rating}}" max="3.0" min=".01" editable step=".01" class="form-item terpene-limonene"></paper-slider>
                </div><!-- end .terpene-amount-container -->
                <div class="terpene-percentage-label">%</div>
              </template>
            </div><!-- end .limonene-toggle-option -->

            <div class="terpene-toggle-option carene-toggle-option">
              <div class="carene-toggle-container">
                <paper-checkbox checked="{{terpenes.carene.presence}}" class="form-item terpene-result terpene-carene" noink>Carene</paper-checkbox>
              </div><!-- end .carene-toggle-container -->
              <template is="dom-if" if="[[terpenes.carene.presence]]">
                <div class="terpene-amount-container">
                  <paper-slider value="{{terpenes.carene.rating}}" max="3.0" min=".01" editable step=".01" class="form-item terpene-carene"></paper-slider>
                </div><!-- end .terpene-amount-container -->
                <div class="terpene-percentage-label">%</div>
              </template>
            </div><!-- end .carene-toggle-option -->

            <div class="terpene-toggle-option beta-ocimene-toggle-option">
              <div class="beta-ocimene-toggle-container">
                <paper-checkbox checked="{{terpenes.betaOcimene.presence}}" class="form-item terpene-result terpene-beta-ocimene" noink>β-Ocimene</paper-checkbox>
              </div><!-- end .beta-ocimene-toggle-container -->
              <template is="dom-if" if="[[terpenes.betaOcimene.presence]]">
                <div class="terpene-amount-container">
                  <paper-slider value="{{terpenes.betaOcimene.rating}}" max="3.0" min=".01" editable step=".01" class="form-item terpene-beta-ocimene"></paper-slider>
                </div><!-- end .terpene-amount-container -->
                <div class="terpene-percentage-label">%</div>
              </template>
            </div><!-- end .beta-ocimene-toggle-option -->

            <div class="terpene-toggle-option alpha-phellandrene-toggle-option">
              <div class="alpha-phellandrene-toggle-container">
                <paper-checkbox checked="{{terpenes.alphaPhellandrene.presence}}" class="form-item terpene-result terpene-alpha-phellandrene" noink>α-Phellandrene</paper-checkbox>
              </div><!-- end .alpha-phellandrene-toggle-container -->
              <template is="dom-if" if="[[terpenes.alphaPhellandrene.presence]]">
                <div class="terpene-amount-container">
                  <paper-slider value="{{terpenes.alphaPhellandrene.rating}}" max="3.0" min=".01" editable step=".01" class="form-item terpene-alpha-phellandrene"></paper-slider>
                </div><!-- end .terpene-amount-container -->
                <div class="terpene-percentage-label">%</div>
              </template>
            </div><!-- end .alpha-phellandrene-toggle-option -->

            <div class="terpene-toggle-option terpinolene-toggle-option">
              <div class="terpinolene-toggle-container">
                <paper-checkbox checked="{{terpenes.terpinolene.presence}}" class="form-item terpene-result terpene-terpinolene" noink>Terpinolene</paper-checkbox>
              </div><!-- end .terpinolene-toggle-container -->
              <template is="dom-if" if="[[terpenes.terpinolene.presence]]">
                <div class="terpene-amount-container">
                  <paper-slider value="{{terpenes.terpinolene.rating}}" max="3.0" min=".01" editable step=".01" class="form-item terpene-terpinolene"></paper-slider>
                </div><!-- end .terpene-amount-container -->
                <div class="terpene-percentage-label">%</div>
              </template>
            </div><!-- end .terpinolene-toggle-option -->

          </div><!-- end .test-result-terpenes -->
        </template>
      </template>

      <!-- Data UI -->
      <template is="dom-if" if="[[!zerostate]]">
        <div class="bloombox-test-results-display">
          <iron-label class="rating-label thc-label"><span>THC: [[_renderLabel(thc, ratingMode)]]</span></iron-label>
          <iron-label class="rating-label cbd-label"><span>CBD: [[_renderLabel(cbd, ratingMode)]]</span></iron-label>

          <iron-label class="terpene-label myrcene-label" hidden$="[[!terpenes.myrcene.presence]]"><span>MYR</span></iron-label>
          <iron-label class="terpene-label caryopyllene-oxide-label" hidden$="[[!terpenes.caryopylleneOxide.presence]]"><span>CRY-O</span></iron-label>
          <iron-label class="terpene-label linalool-label" hidden$="[[!terpenes.linalool.presence]]"><span>LIN</span></iron-label>
          <iron-label class="terpene-label beta-caryophyllene-label" hidden$="[[!terpenes.betaCaryophyllene.presence]]"><span>β-CRY</span></iron-label>
          <iron-label class="terpene-label alpha-humulene-label" hidden$="[[!terpenes.alphaHumulene.presence]]"><span>α-HUM</span></iron-label>
          <iron-label class="terpene-label alpha-terpineol-label" hidden$="[[!terpenes.alphaTerpineol.presence]]"><span>α-TRP</span></iron-label>
          <iron-label class="terpene-label camphene-label" hidden$="[[!terpenes.camphene.presence]]"><span>CAM</span></iron-label>
          <iron-label class="terpene-label fenchol-label" hidden$="[[!terpenes.fenchol.presence]]"><span>FEN</span></iron-label>
          <iron-label class="terpene-label beta-pinene-label" hidden$="[[!terpenes.betaPinene.presence]]"><span>β-PNE</span></iron-label>
          <iron-label class="terpene-label alpha-terpinine-label" hidden$="[[!terpenes.alphaTerpinine.presence]]"><span>α-TPN</span></iron-label>
          <iron-label class="terpene-label alpha-pinene-label" hidden$="[[!terpenes.alphaPinene.presence]]"><span>α-PNE</span></iron-label>
          <iron-label class="terpene-label gamma-terpinine-label" hidden$="[[!terpenes.gammaTerpinine.presence]]"><span>γ-TPN</span></iron-label>
          <iron-label class="terpene-label limonene-label" hidden$="[[!terpenes.limonene.presence]]"><span>LMN</span></iron-label>
          <iron-label class="terpene-label carene-label" hidden$="[[!terpenes.carene.presence]]"><span>CRN</span></iron-label>
          <iron-label class="terpene-label beta-ocimene-label" hidden$="[[!terpenes.betaOcimene.presence]]"><span>β-OCI</span></iron-label>
          <iron-label class="terpene-label alpha-phellandrene-label" hidden$="[[!terpenes.alphaPhellandrene.presence]]"><span>α-PHL</span></iron-label>
          <iron-label class="terpene-label terpinolene-label" hidden$="[[!terpenes.terpinolene.presence]]"><span>TPO</span></iron-label>
        </div><!-- end .bloombox-test-results-display -->
      </template>
    </template>
  </div><!-- end #widgetWrap.bloombox-testing-content -->

  <script>
    Polymer.BloomboxTesting = Polymer({
      is: 'bloombox-testing',

      properties: {
        /**
         * Computed flag property indicating whether we are showing/editing `rich`
         * test results.
         */
        _rich: {
          type: Boolean,
          computed: '_computeRichMode(mode)'
        },

        /**
         * Computed object property describing the parameters we should use to
         * govern `<paper-slider>` ratings, based on the current `ratingMode`.
         * Things that are provided by this object:
         * - `limit_hint`: Provides a `secondary-progress` value to hint at the
         *   generally-sane range for a particular rating type.
         * - `step`: Provides an amount for the `step` property to govern how
             much an individual step increments or decrements the value.
         * - `max`: Provides a maximum value for the rating.
         */
        _ratingModeParams: {
          type: Object,
          computed: '_computeRatingModeParams(ratingMode)'
        },

        /**
         * Computed flag that controls whether we should place an overlay over the
         * element with a "Results Pending" message.
         */
        _overlayActive: {
          type: Boolean,
          computed: '_computeOverlay(zerostate, cbd, thc, terpenes)'
        },

        /**
         * Flag indicating that we should be showing a form to edit test results.
         */
        zerostate: {
          type: Boolean,
          notify: true,
          value: false
        },

        /**
         * Rating mode setting. Informs the UI of the unit that the rating value
         * is representing. Options include:
         * - `%`: The rating value is a percentage.
         * - `mg`: The rating value is a measurement in milligrams.
         */
        ratingMode: {
          type: String,
          notify: true,
          value: 'mg'
        },

        /**
         * Computed flag property indicating whether this widget supports dynamic
         * a rating mode.
         */
        dynamicRatingMode: {
          type: Boolean,
          notify: true,
          value: false
        },

        /**
         * Testing mode setting. There are two options: `basic` and `rich`:
         * - `basic`: THC and CBD testing values only.
         * - `rich`: Includes `basic`, plus a spread of `terpene` flags
         */
        mode: {
          type: String,
          notify: true,
          value: "basic"
        },

        /**
         * CBD value detected/indicated by the tests.
         */
        cbd: {
          type: Number,
          notify: true,
          value: 0
        },

        /**
         * THC value detected/indicated by the tests.
         */
        thc: {
          type: Number,
          notify: true,
          value: 0
        },

        /**
         * Computed, read-only function providing terpene status.
         */
        terpenes: {
          type: Object,
          notify: true,
          observer: '_observeTerpenes',
          value: function() {
            return defaultTerpeneConfig();
          }
        }
      },

      /**
       * Computed property function that returns whether we are running
       * in `rich` testing mode or not.
       */
      _computeRichMode: function(mode) {
        return mode == "rich";
      },

      /**
       * Computed property function that returns whether we should be
       * showing the dynamic rating mode UI.
       */
      _computeDynamicRatingMode: function(ratingMode) {
        return ratingMode === "dynamic";
      },

      /**
       * Computed property function that provides parameters for configuring
       * `<paper-slider>` ratings based on the current `ratingMode`.
       */
      _computeRatingModeParams: function(ratingMode) {
        if (ratingMode === "%") {
          return {
            limit_hint: 20.0,
            step: 0.1,
            max: 40.0
          };
        } else if (ratingMode === "mg") {
          return {
            limit_hint: 200,
            step: 1,
            max: 2000
          };
        }
      },

      /**
       * Computed property function that controls whether we should be
       * showing a "Results Pending" overlay.
       */
      _computeOverlay: function(zerostate, cbd, thc, terpenes) {
        if (!zerostate && cbd === 0 && thc === 0 && !(typeof terpenes === "object" && Object.keys(terpenes).length > 0))
          return this._toggleOverlay(true);
        return this._toggleOverlay(false);
      },

      /**
       * Property observer that makes sure terpene data is properly
       * formatted.
       */
      _observeTerpenes: function(terpeneData) {
        if (terpeneData === undefined || terpeneData == null) {
          this.terpenes = defaultTerpeneConfig();
        }
      },

      /**
       * Helper function to perform the dirty work of showing and hiding
       * the results-pending overlay.
       */
      _toggleOverlay: function(enabled) {
        var wrapElement = this.$.widgetWrap;
        if (enabled) {
          if (!wrapElement.classList.contains("no-test-data"))
            wrapElement.classList.add("no-test-data");
        } else {
          wrapElement.classList.remove("no-test-data");
        }
        return enabled;
      },

      /**
       * Render function that decides whether to show results in percentage
       * or milligram form based on the current `ratingMode`.
       */
      _renderLabel: function(value, ratingMode) {
        return value + ratingMode;
      }
    });
  </script>
</dom-module>
